Reservation sync started
#<Net::HTTPOK:0x00007ff334959d20>
Reservation sync started
#<Net::HTTPOK:0x00007f9bc7b15368>
Reservation sync started
#<Net::HTTPOK:0x00007f87292d9b70>
Reservation sync started
#<Net::HTTPOK:0x00007fda04eade50>
Reservation sync started
#<Net::HTTPOK:0x00007ffe713c5da8>
Reservation sync started
#<Net::HTTPOK:0x00007fec49c7dd90>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     response['reservations'].each do |r|
    18:       hotel.reservations.create(room_id: r['roomId'], name: r['name'], phone: r['phone'], places: r['places'],
    19:                                          description: r['description'], deposit: r['deposit'],
    20:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    21:     end

[0G[1] pry(main)> Reservation sync started
#<Net::HTTPOK:0x00007f952cd6dc88>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     response['reservations'].each do |r|
    18:       hotel.reservations.create(room_id: r['roomId'], name: r['name'], phone: r['phone'], places: r['places'],
    19:                                          description: r['description'], deposit: r['deposit'],
    20:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    21:     end

[0G[1] pry(main)> Reservation sync started
#<Net::HTTPOK:0x00007fc1436e9f18>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     response['reservations'].each do |r|
    18:       hotel.reservations.create(room_id: r['roomId'], name: r['name'], phone: r['phone'], places: r['places'],
    19:                                          description: r['description'], deposit: r['deposit'],
    20:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    21:     end

[0G[1] pry(main)> Reservation sync started
#<Net::HTTPOK:0x00007f9be55b6020>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     response['reservations'].each do |r|
    18:       hotel.reservations.create(room_id: r['roomId'], name: r['name'], phone: r['phone'], places: r['places'],
    19:                                          description: r['description'], deposit: r['deposit'],
    20:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    21:     end

[0G[1] pry(main)> Reservation sync started
#<Net::HTTPOK:0x00007face87d93c0>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     response['reservations'].each do |r|
    18:       hotel.reservations.create(room_id: r['roomId'], name: r['name'], phone: r['phone'], places: r['places'],
    19:                                          description: r['description'], deposit: r['deposit'],
    20:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    21:     end

[0G[1] pry(main)> Reservation sync started
#<Net::HTTPOK:0x00007fd911029c88>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     response['reservations'].each do |r|
    18:       hotel.reservations.create(room_id: r['roomId'], name: r['name'], phone: r['phone'], places: r['places'],
    19:                                          description: r['description'], deposit: r['deposit'],
    20:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    21:     end

[0G[1] pry(main)> Reservation sync started
#<Net::HTTPOK:0x00007f9877521c70>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     response['reservations'].each do |r|
    18:       hotel.reservations.create(room_id: r['roomId'], name: r['name'], phone: r['phone'], places: r['places'],
    19:                                          description: r['description'], deposit: r['deposit'],
    20:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    21:     end

[0G[1] pry(main)> Reservation sync started
#<Net::HTTPOK:0x00007fbc16422208>
Reservation sync started
#<Net::HTTPOK:0x00007fa4a6a01fc0>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       hotel.reservations.create(room_id: r['roomId'], name: r['name'], phone: r['phone'], places: r['places'],
    19:                                          description: r['description'], deposit: r['deposit'],
    20:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    21:     end

[0G[1] pry(main)> Reservation sync started
#<Net::HTTPOK:0x00007fa470595e90>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       hotel.reservations.create(room_id: r['roomId'], name: r['name'], phone: r['phone'], places: r['places'],
    19:                                          description: r['description'], deposit: r['deposit'],
    20:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    21:     end

[0G[1] pry(main)> Reservation sync started
#<Net::HTTPOK:0x00007f93a4f85ea0>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       hotel.reservations.create(room_id: r['roomId'], name: r['name'], phone: r['phone'], places: r['places'],
    19:                                          description: r['description'], deposit: r['deposit'],
    20:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    21:     end

[0G[1] pry(main)> Reservation sync started
#<Net::HTTPOK:0x00007fbb78eb6758>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       hotel.reservations.create(room_id: r['roomId'], name: r['name'], phone: r['phone'], places: r['places'],
    19:                                          description: r['description'], deposit: r['deposit'],
    20:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    21:     end

[0G[1] pry(main)> Reservation sync started
#<Net::HTTPOK:0x00007fca9e63e898>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       hotel.reservations.create(room_id: r['roomId'], name: r['name'], phone: r['phone'], places: r['places'],
    19:                                          description: r['description'], deposit: r['deposit'],
    20:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    21:     end

[0G[1] pry(main)> Reservation sync started
#<Net::HTTPOK:0x00007fad9d43e228>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       hotel.reservations.create(room_id: r['roomId'], name: r['name'], phone: r['phone'], places: r['places'],
    19:                                          description: r['description'], deposit: r['deposit'],
    20:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    21:     end

[0G[1] pry(main)> Reservation sync started
#<Net::HTTPOK:0x00007fcc506d5f28>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       hotel.reservations.create(room_id: Room.find_by_number(r['roomNumber']).try(:id), name: r['name'], phone: r['phone'], places: r['places'],
    19:                                          description: r['description'], deposit: r['deposit'],
    20:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    21:     end

[0G[1] pry(main)> Reservation sync started
#<Net::HTTPOK:0x00007f9e5c562190>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       hotel.reservations.create(room_id: Room.find_by_number(r['roomId']).try(:id), name: r['name'], phone: r['phone'], places: r['places'],
    19:                                          description: r['description'], deposit: r['deposit'],
    20:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    21:     end

[0G[1] pry(main)> Reservation sync started
#<Net::HTTPOK:0x00007f87d8c755d0>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       hotel.reservations.create(room_id: Room.find_by_number(r['roomId']).try(:id), name: r['name'], phone: r['phone'], places: r['places'],
    19:                                          description: r['description'], deposit: r['deposit'],
    20:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    21:     end

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> Reservation sync started
#<Net::HTTPOK:0x00007fc35f5820a8>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       hotel.reservations.create(room_id: Room.find_by_number(r['roomId']).try(:id), name: r['name'], phone: r['phone'], places: r['places'],
    19:                                          description: r['description'], deposit: r['deposit'],
    20:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    21:     end

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> Reservation sync started
#<Net::HTTPOK:0x00007fd00d3ad6f0>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
    19:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    20:                                          description: r['description'], deposit: r['deposit'],
    21:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> Reservation sync started
#<Net::HTTPOK:0x00007f9c49eb5db0>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
    19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 19 :

    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
 => 19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],
    22:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    23:     end
    24:     sleep 5

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> Reservation sync started
#<Net::HTTPOK:0x00007ff200ea16a0>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
    19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 19 :

    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
 => 19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],
    22:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    23:     end
    24:     sleep 5

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> Reservation sync started
#<Net::HTTPOK:0x00007fdb14c59f58>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
    19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 19 :

    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
 => 19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],
    22:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    23:     end
    24:     sleep 5

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> Reservation sync started
#<Net::HTTPOK:0x00007f9f8e5e9d88>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
    19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 19 :

    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
 => 19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],
    22:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    23:     end
    24:     sleep 5

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> Reservation sync started
#<Net::HTTPOK:0x00007fa661f55aa0>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
    19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 19 :

    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
 => 19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],
    22:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    23:     end
    24:     sleep 5

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> Reservation sync started
#<Net::HTTPOK:0x00007fa8cacf1e60>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
    19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 19 :

    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
 => 19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],
    22:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    23:     end
    24:     sleep 5

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> Reservation sync started
#<Net::HTTPOK:0x00007fa3ad575fc8>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
    19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 19 :

    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
 => 19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],
    22:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    23:     end
    24:     sleep 5

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 19 :

    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
 => 19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],
    22:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    23:     end
    24:     sleep 5

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fd0e13fdb58>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
    19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 19 :

    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
 => 19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],
    22:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    23:     end
    24:     sleep 5

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 19 :

    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
 => 19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],
    22:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    23:     end
    24:     sleep 5

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007ff7ba519f00>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
    19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 19 :

    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
 => 19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],
    22:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    23:     end
    24:     sleep 5

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 19 :

    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
 => 19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],
    22:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    23:     end
    24:     sleep 5

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007ff9b73c92f0>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 16 :

    11:     http = Net::HTTP.new(heroku_request_endpoint.host, heroku_request_endpoint.port)
    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
 => 16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
    19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 19 :

    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
 => 19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],
    22:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    23:     end
    24:     sleep 5

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 19 :

    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     binding.pry
    17:     JSON.parse(response.body)['reservations'].each do |r|
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
 => 19:       binding.pry
    20:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    21:                                          description: r['description'], deposit: r['deposit'],
    22:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    23:     end
    24:     sleep 5

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007f9bc71ce200>

From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fe75f68dc58>

From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007f7f1efd5f08>

From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007f8b06e70fe8>

From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fb31e5a9b18>

From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fab59b19ca0>

From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fc5975d5ea8>

From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007ffc728fe168>

From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fe5ea6195b8>

From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fd1e45b7710>

From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fcc2c50dbb0>

From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fdf4a68a520>

From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fa384cd9f18>

From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fea46c4e1a8>

From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fbede35e338>

From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fea7d7b3670>

From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fbebfe39088>

From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fcd16ef7078>

From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> 
From: /Users/vandal/Projects/drag/app/models/reservation.rb @ line 36 Reservation#check_availability:

    35: def check_availability
 => 36:   binding.pry
    37:   unless ratrak_id
    38:     room = Room.find_by_id(room_id)
    39:     room_places = room.places
    40:     existed = room.reservations.approved.where('start_date < ? AND end_date > ?', end_date, start_date)
    41:     sum = existed.map {|reservation| reservation.places}.sum
    42:     control_sum = if id.nil? || (start_date_changed? && !(existed.count == 1 && existed.first.id == id)) ||
    43:       (end_date_changed? && !(existed.count == 1 && existed.first.id == id)) || room_id_changed? || (status_changed? && status == 'approved')
    44:       sum + places
    45:     elsif places_changed? && places_was < places
    46:       existed.select {|r| r.id != id}.map {|reservation| reservation.places}.sum + places
    47:     else
    48:       sum
    49:     end
    50:     if room_places < control_sum
    51:       errors.add(:base, '–¶–µ–π –Ω–æ–º–µ—Ä –≤ —Ü—ñ –¥–∞—Ç–∏ –≤–∂–µ –Ω–µ –ø–æ–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—ñ–ª—å–∫–∏ –≥–æ—Å—Ç–µ–π')
    52:     else
    53:       BookingResponseJob.perform_later(self, status) if user_id && status_changed? && !new_record?
    54:     end
    55:   end
    56: end

[0G[1] pry(#<Reservation>)> [{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"approved","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007feb13278d40>
[{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"approved","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007f82764d9ce8>
[{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"approved","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fb3ec476600>
[{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"approved","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fac68c511d0>
[{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"approved","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fcc0e2f1f98>
[{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"approved","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fb6e87b93e0>
[{"roomId":4,"name":"danil","phone":"2312323123","places":2,"description":"","deposit":null,"status":"approved","startDate":"11.09.2019","endDate":"13.09.2019"},{"roomId":4,"name":"vasil","phone":"0975432178","places":1,"description":"done","deposit":4000,"status":"approved","startDate":"22.09.2019","endDate":"26.09.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"approved","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fcca3109ee8>
[{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007f9b66c75890>
[{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fbfe8d45eb8>
[{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007ff35ae15b18>
[{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007f8e74d51bf0>
[{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fb18e519c98>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 17 :

    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     JSON.parse(response.body)['reservations'].each do |r|
 => 17:       binding.pry
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
    19:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    20:                                          description: r['description'], deposit: r['deposit'],
    21:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    22:     end

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 17 :

    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     JSON.parse(response.body)['reservations'].each do |r|
 => 17:       binding.pry
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
    19:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    20:                                          description: r['description'], deposit: r['deposit'],
    21:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    22:     end

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 17 :

    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     JSON.parse(response.body)['reservations'].each do |r|
 => 17:       binding.pry
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
    19:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    20:                                          description: r['description'], deposit: r['deposit'],
    21:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    22:     end

[0G[1] pry(main)> [{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fe18ded5168>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 17 :

    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     JSON.parse(response.body)['reservations'].each do |r|
 => 17:       binding.pry
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
    19:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    20:                                          description: r['description'], deposit: r['deposit'],
    21:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    22:     end

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 17 :

    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     JSON.parse(response.body)['reservations'].each do |r|
 => 17:       binding.pry
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
    19:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    20:                                          description: r['description'], deposit: r['deposit'],
    21:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    22:     end

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 17 :

    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     JSON.parse(response.body)['reservations'].each do |r|
 => 17:       binding.pry
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
    19:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    20:                                          description: r['description'], deposit: r['deposit'],
    21:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    22:     end

[0G[1] pry(main)> [{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007ff6f233d268>

From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 17 :

    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     JSON.parse(response.body)['reservations'].each do |r|
 => 17:       binding.pry
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
    19:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    20:                                          description: r['description'], deposit: r['deposit'],
    21:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    22:     end

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 17 :

    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     JSON.parse(response.body)['reservations'].each do |r|
 => 17:       binding.pry
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
    19:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    20:                                          description: r['description'], deposit: r['deposit'],
    21:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    22:     end

[0G[1] pry(main)> 
From: /Users/vandal/Projects/drag/lib/tasks/reservations_sync.rake @ line 17 :

    12:     http.use_ssl = true
    13:     heroku_request_endpoint.query = URI.encode_www_form({hotel: '–ü—ñ–ø–∞—à', email: 'vasilpipash@gmail.com'})
    14:     response = http.get(heroku_request_endpoint.request_uri)
    15:     puts response
    16:     JSON.parse(response.body)['reservations'].each do |r|
 => 17:       binding.pry
    18:       room_id = Room.find_by_number(r['roomId']).try(:id)
    19:       hotel.reservations.create(room_id: room_id, name: r['name'], phone: r['phone'], places: r['places'],
    20:                                          description: r['description'], deposit: r['deposit'],
    21:                                          start_date: r['startDate'], end_date: r['endDate'], status: r['status'])
    22:     end

[0G[1] pry(main)> [{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fa69157e178>
[{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fb971055d48>
[{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
#<Net::HTTPOK:0x00007fab837b1de0>
[{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":7,"name":"–ï–≤–≥–µ–Ω–∏—è ","phone":"0506245905","places":3,"description":"–≤—Ö–æ–¥–∏—Ç –ø–∏—Ç–∞–Ω–∏–µ  –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å   ?","deposit":null,"status":"pending","startDate":"29.12.2019","endDate":"02.01.2020"},{"roomId":17,"name":"–ú–∞–∫—Å–∏–º","phone":"066-652-38-82","places":3,"description":null,"deposit":null,"status":"pending","startDate":"25.12.2019","endDate":"29.12.2019"},{"roomId":4,"name":"–Ø–Ω","phone":"0999241220","places":2,"description":"–ü–æ—Ç—Äi–±–Ω–æ –¥–≤–∞ –Ω–æ–º–µ—Ä–∏. –üi–¥–∫–∞–∂i—Ç—å, —Üi–Ω–∞ 600 –≥—Ä–Ω —Ü–µ –∑–∞ –Ωi—á? +380999241220 - –ºi–π –í–∞–π–±–µ—Ä! ","deposit":null,"status":"approved","startDate":"15.02.2019","endDate":"16.02.2019"}]
Reservation sync ended
Reservation sync started
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
Reservation sync started
Reservation sync ended
